{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabai-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { gallery } from '../main';\n\n//Lightbox\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n});\n\n//Rendering function\nfunction renderPictures(pics, isFirstLoad) {\n  const markup = pics\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        //Markup\n        return `\n  <li class='gallery__item'>\n         <a href='${largeImageURL}'>\n          <img src='${webformatURL}' alt='${tags}'>\n        </a>\n      <div class=\"info\">\n        <div class='info-item'>\n         <p class='main-p'>Likes</p>\n         <p>${likes}</p>\n        </div>\n        <div class='info-item'>\n         <p class='main-p'>Views</p>\n         <p>${views}</p>\n        </div>\n        <div class='info-item'>\n         <p class='main-p'>Comments</p>\n         <p>${comments}</p>\n        </div>\n        <div class='info-item'>\n         <p class='main-p'>Downloads</p>\n         <p>${downloads}</p>\n        </div>\n      </div>\n  </li>\n      `;\n      }\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  const lastCard = gallery.lastElementChild;\n  const cardHeight = lastCard.getBoundingClientRect().height;\n  const scrollDist = cardHeight * 2;\n\n  if (!isFirstLoad) {\n    window.scrollBy({\n      top: scrollDist,\n      behavior: 'smooth',\n    });\n  }\n\n  //Renewing the gallery\n  lightbox.refresh();\n}\n\nexport default renderPictures;\n","//Imports\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\n//Declarations\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst key = '41103551-afb5440a0c91585482e280fcd';\nconst loader = document.querySelector('.loader');\nlet page = 1;\nlet perPage = 15;\nlet isLoading = false;\nexport let userSearchQuery = '';\nloadMoreBtn.style.display = 'none';\n\nexport async function getPictures(query, renderFn, isFirstLoad = false) {\n  if (isLoading) return;\n  isLoading = true;\n  if (userSearchQuery !== query) {\n    userSearchQuery = query;\n    page = 1;\n  }\n\n  //search parameters\n  const searchParams = new URLSearchParams({\n    key,\n    page,\n    per_page: perPage,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  });\n\n  const url = `https://pixabay.com/api/?${searchParams}`;\n\n  try {\n    loader.style.display = 'block';\n    const res = await axios.get(url);\n    const pictures = res.data.hits;\n    const totalHits = res.data.totalHits;\n\n    if (pictures.length === 0 && page === 1) {\n      loadMoreBtn.style.display = 'none';\n\n      iziToast.error({\n        title: 'No pictures found',\n        message: 'Try another query',\n        messageColor: 'black',\n        messageSize: '14px',\n        position: 'topCenter',\n        timeout: 3000,\n        closeOnClick: true,\n      });\n    } else {\n      page += 1;\n      //showing the found pictures\n      renderFn(pictures, isFirstLoad);\n      loadMoreBtn.style.display = 'block';\n    }\n    //no more pictures logic\n    if (page > Math.ceil(totalHits / perPage) && totalHits > 0) {\n      loadMoreBtn.style.display = 'none';\n      iziToast.error({\n        title: `We're sorry, but you've reached the end of search results.`,\n        message: 'Try another query',\n        messageColor: 'black',\n        messageSize: '14px',\n        position: 'topCenter',\n        timeout: 3000,\n        closeOnClick: true,\n      });\n    }\n  } catch (e) {\n    console.error(e);\n  } finally {\n    loader.style.display = 'none';\n    isLoading = false;\n  }\n}\n\n//\n// INFINITY SCROLL\n//\n\n//\n\n// //Imports\n// import iziToast from 'izitoast';\n// import 'izitoast/dist/css/iziToast.min.css';\n// import axios from 'axios';\n\n// //Declarations\n// const guard = document.querySelector('.guard');\n// const key = '41103551-afb5440a0c91585482e280fcd';\n// const loader = document.querySelector('.loader');\n// let page = 1;\n// let perPage = 15;\n// let observer = null;\n// let isLoading = false;\n// export let userSearchQuery = '';\n\n// //\n\n// // Observer\n// function createObserver(renderFn) {\n//   const options = {\n//     root: null,\n//     rootMargin: '500px',\n//     threshold: 0,\n//   };\n\n//   observer = new IntersectionObserver((entries, observer) => {\n//     entries.forEach(entry => {\n//       if (entry.isIntersecting) {\n//         getPictures(userSearchQuery, renderFn);\n//       }\n//     }, options);\n//   });\n\n//   observer.observe(guard);\n// }\n\n// //\n// //\n// export async function getPictures(query, renderFn, isFirstLoad = false) {\n//   if (isLoading) return;\n//   isLoading = true;\n\n//   if (userSearchQuery !== query) {\n//     userSearchQuery = query;\n//     page = 1;\n//   }\n\n//   if (!observer) {\n//     createObserver(renderFn);\n//   }\n\n//   //search parameters\n//   const searchParams = new URLSearchParams({\n//     key,\n//     page,\n//     per_page: perPage,\n//     q: query,\n//     image_type: 'photo',\n//     orientation: 'horizontal',\n//     safesearch: true,\n//   });\n\n//   const url = `https://pixabay.com/api/?${searchParams}`;\n\n//   try {\n//     loader.style.display = 'block';\n//     isLoading = true;\n//     const res = await axios.get(url);\n//     const pictures = res.data.hits;\n//     const totalHits = res.data.totalHits;\n\n//     if (pictures.length === 0 && page === 1) {\n//       iziToast.error({\n//         title: 'No pictures found',\n//         message: 'Try another query',\n//         messageColor: 'black',\n//         messageSize: '14px',\n//         position: 'topCenter',\n//         timeout: 3000,\n//         closeOnClick: true,\n//       });\n//     } else {\n//       page += 1;\n//       //showing the found pictures\n//       renderFn(pictures, isFirstLoad);\n//     }\n//     //no more pictures logic\n//     if (page > Math.ceil(totalHits / perPage)) {\n//       observer.disconnect();\n//       iziToast.error({\n//         title: `We're sorry, but you've reached the end of search results.`,\n//         message: 'Try another query',\n//         messageColor: 'black',\n//         messageSize: '14px',\n//         position: 'topCenter',\n//         timeout: 3000,\n//         closeOnClick: true,\n//       });\n//     }\n//   } catch (e) {\n//     console.error(e);\n//   } finally {\n//     loader.style.display = 'none';\n//     isLoading = false;\n//   }\n// }\n","import renderPictures from './js/render-functions';\nimport { getPictures, userSearchQuery } from './js/pixabai-api';\n\n//Declarations\nconst form = document.getElementById('form');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nexport const gallery = document.querySelector('.gallery');\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n\n  //Getting info from the input\n  const searchValue = e.target.elements.searchquery.value;\n  if (searchValue.trim() === '') return;\n  gallery.innerHTML = '';\n  getPictures(searchValue, renderPictures, true);\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  getPictures(userSearchQuery, renderPictures, false);\n});\n\n//\n//\n\n//\n// INFINITY SCROLL\n//\n\n//\n// import renderPictures from './js/render-functions';\n// import { getPictures, userSearchQuery } from './js/pixabai-api';\n\n// //Declarations\n// const form = document.getElementById('form');\n// const loadMoreBtn = document.querySelector('.load-more-btn');\n// export const gallery = document.querySelector('.gallery');\n\n// form.addEventListener('submit', e => {\n//   e.preventDefault();\n\n//   //Getting info from the input\n//   const searchValue = e.target.elements.searchquery.value;\n//   if (searchValue.trim() === '') return;\n//   gallery.innerHTML = '';\n//   getPictures(searchValue, renderPictures, true);\n// });\n"],"names":["lightbox","SimpleLightbox","renderPictures","pics","isFirstLoad","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","gallery","scrollDist","loadMoreBtn","key","loader","page","perPage","isLoading","userSearchQuery","getPictures","query","renderFn","url","res","axios","pictures","totalHits","iziToast","e","form","searchValue"],"mappings":"owBAKA,MAAMA,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,KAChB,CAAC,EAGD,SAASC,EAAeC,EAAMC,EAAa,CACzC,MAAMC,EAASF,EACZ,IACC,CAAC,CACC,aAAAG,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAEe;AAAA;AAAA,oBAEKL,CAAa;AAAA,sBACXD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,cAKlCC,CAAK;AAAA;AAAA;AAAA;AAAA,cAILC,CAAK;AAAA;AAAA;AAAA;AAAA,cAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,cAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,OAMlB,EACA,KAAK,EAAE,EACVC,EAAQ,mBAAmB,YAAaR,CAAM,EAG9C,MAAMS,EAFWD,EAAQ,iBACG,sBAAqB,EAAG,OACpB,EAE3BT,GACH,OAAO,SAAS,CACd,IAAKU,EACL,SAAU,QAChB,CAAK,EAIHd,EAAS,QAAO,CAClB,CC3DA,MAAMe,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAM,qCACNC,EAAS,SAAS,cAAc,SAAS,EAC/C,IAAIC,EAAO,EACPC,EAAU,GACVC,EAAY,GACLC,EAAkB,GAC7BN,EAAY,MAAM,QAAU,OAErB,eAAeO,EAAYC,EAAOC,EAAUpB,EAAc,GAAO,CACtE,GAAIgB,EAAW,OACfA,EAAY,GACRC,IAAoBE,IACtBF,EAAkBE,EAClBL,EAAO,GAcT,MAAMO,EAAM,4BAVS,IAAI,gBAAgB,CACvC,IAAAT,EACA,KAAAE,EACA,SAAUC,EACV,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,EAChB,CAAG,CAEmD,GAEpD,GAAI,CACFN,EAAO,MAAM,QAAU,QACvB,MAAMS,EAAM,MAAMC,EAAM,IAAIF,CAAG,EACzBG,EAAWF,EAAI,KAAK,KACpBG,EAAYH,EAAI,KAAK,UAEvBE,EAAS,SAAW,GAAKV,IAAS,GACpCH,EAAY,MAAM,QAAU,OAE5Be,EAAS,MAAM,CACb,MAAO,oBACP,QAAS,oBACT,aAAc,QACd,YAAa,OACb,SAAU,YACV,QAAS,IACT,aAAc,EACtB,CAAO,IAEDZ,GAAQ,EAERM,EAASI,EAAUxB,CAAW,EAC9BW,EAAY,MAAM,QAAU,SAG1BG,EAAO,KAAK,KAAKW,EAAYV,CAAO,GAAKU,EAAY,IACvDd,EAAY,MAAM,QAAU,OAC5Be,EAAS,MAAM,CACb,MAAO,6DACP,QAAS,oBACT,aAAc,QACd,YAAa,OACb,SAAU,YACV,QAAS,IACT,aAAc,EACtB,CAAO,EAEJ,OAAQC,EAAG,CACV,QAAQ,MAAMA,CAAC,CACnB,QAAY,CACRd,EAAO,MAAM,QAAU,OACvBG,EAAY,EACb,CACH,CC3EA,MAAMY,EAAO,SAAS,eAAe,MAAM,EACrCjB,EAAc,SAAS,cAAc,gBAAgB,EAC9CF,EAAU,SAAS,cAAc,UAAU,EAExDmB,EAAK,iBAAiB,SAAUD,GAAK,CACnCA,EAAE,eAAc,EAGhB,MAAME,EAAcF,EAAE,OAAO,SAAS,YAAY,MAC9CE,EAAY,SAAW,KAC3BpB,EAAQ,UAAY,GACpBS,EAAYW,EAAa/B,EAAgB,EAAI,EAC/C,CAAC,EAEDa,EAAY,iBAAiB,QAAS,SAAY,CAChDO,EAAYD,EAAiBnB,EAAgB,EAAK,CACpD,CAAC"}